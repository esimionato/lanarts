From https://crawl.develz.org/mantis/view.php?id=5906

Credit to roctavian
