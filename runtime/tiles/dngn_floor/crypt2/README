From https://crawl.develz.org/mantis/view.php?id=6073
Credits to white_noise 
