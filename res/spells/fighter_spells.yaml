---
spells:

  - name: Berserk
    description: 
      Allows you to strike powerful blows for a limited duration,
      afterwards you are slower and vulnerable.
    mp_cost: 40
    cooldown: 30
    spr_spell: berserk
    can_cast_with_held_key: no
    fallback_to_melee: no
    prereq_func: 
      function(caster, _, _) 
        return not caster:has_effect("Berserk") and not caster:has_effect("Exhausted")
      end
    action_func: 
      function(caster, x, y) 
        caster:add_effect("Berserk", 150 + caster.stats.level * 20) 
        if caster:is_local_player() then 
          show_message("You enter a powerful rage!", {200,200,255}) 
        elseif caster.name == "Your ally" then
          show_message(caster.name .. " enters a powerful rage!", {200,200,255}) 
        end
      end
    autotarget_func: 
      function (caster, _) return caster.x, caster.y end

  - name: Power Strike
    description: 
      A powerful charged strike. Deals stunning blows to all surrounding enemies, knocking them back.
    mp_cost: 40
    cooldown: 30
    spr_spell: chargestrike
    can_cast_with_cooldown: yes
    can_cast_with_held_key: no
    fallback_to_melee: no
    prereq_func: 
      function(caster, _, _) 
        for mon in level.monsters() do
          if distance({mon.x, mon.y}, {caster.x, caster.y}) < mon.target_radius + caster.target_radius + 40 then
            return true
          end
        end
        return false
      end
    action_func: powerstrike_spell.action
    autotarget_func: 
      function (caster, _) return caster.x, caster.y end